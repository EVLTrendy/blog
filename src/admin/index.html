<!doctype html>
<html>

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="noindex" />
  <title>Complete Content Management System</title>
  <link rel="stylesheet" href="https://unpkg.com/sakura.css/css/sakura.css">
  <style>
    /* Reset Sakura constraints for full-width CMS layout */
    body {
      max-width: 100% !important;
      padding: 0 !important;
      margin: 0 !important;
      background-color: #f0f2f5;
    }

    .cms-sidebar {
      position: fixed;
      left: 0;
      top: 0;
      width: 260px;
      height: 100vh;
      background: #ffffff;
      padding: 25px 35px 25px 25px;
      /* Added right padding */
      overflow-y: auto;
      border-right: 1px solid #e1e4e8;
      box-shadow: 2px 0 5px rgba(0, 0, 0, 0.03);
      z-index: 100;
    }

    .cms-main {
      margin-left: 300px;
      /* Increased to separate from sidebar */
      padding: 40px;
      max-width: 1600px;
      margin-right: auto;
    }

    .cms-nav-item {
      display: block;
      padding: 12px 15px;
      margin: 8px 0;
      text-decoration: none;
      color: #4a5568;
      border-radius: 8px;
      transition: all 0.2s ease;
      font-weight: 500;
    }

    .cms-nav-item:hover,
    .cms-nav-item.active {
      background: #33bdef;
      color: white;
      transform: translateX(5px);
    }

    .content-section {
      display: none;
      animation: fadeIn 0.3s ease;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .content-section.active {
      display: block;
    }

    .content-list {
      margin: 25px 0;
      display: grid;
      gap: 15px;
    }

    .content-item {
      padding: 20px;
      border: 1px solid #e2e8f0;
      margin: 0;
      background: #ffffff;
      border-radius: 10px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.02);
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .content-item:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
    }

    .content-item h4 {
      margin: 0 0 10px 0;
      font-size: 1.1em;
      color: #2d3748;
    }

    .content-meta {
      color: #718096;
      font-size: 0.9em;
      line-height: 1.5;
    }

    .content-actions {
      margin-top: 15px;
      display: flex;
      gap: 10px;
    }

    .form-section {
      display: none;
      animation: fadeIn 0.3s;
    }

    .form-section.active {
      display: block;
    }

    .btn {
      padding: 10px 20px;
      margin: 0;
      cursor: pointer;
      border: 1px solid transparent;
      background: #edf2f7;
      border-radius: 6px;
      font-weight: 500;
      transition: all 0.2s;
    }

    .btn:hover {
      filter: brightness(95%);
      transform: translateY(-1px);
    }

    .btn.primary {
      background: #33bdef;
      color: white;
      box-shadow: 0 2px 4px rgba(51, 189, 239, 0.3);
    }

    .btn.primary:hover {
      background: #2daadd;
      box-shadow: 0 4px 6px rgba(51, 189, 239, 0.4);
    }

    .btn.success {
      background: #48bb78;
      color: white;
    }

    .btn.warning {
      background: #ecc94b;
      color: #2d3748;
    }

    .btn.danger {
      background: #f56565;
      color: white;
    }

    .btn.info {
      background: #4299e1;
      color: white;
    }

    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(26, 32, 44, 0.7);
      z-index: 1000;
      backdrop-filter: blur(4px);
    }

    .modal-content {
      background: white;
      margin: 3vh auto;
      padding: 40px;
      width: 90%;
      max-width: 1200px;
      border-radius: 12px;
      max-height: 94vh;
      overflow-y: auto;
      box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
    }

    form {
      margin-top: 25px;
    }

    label {
      display: block;
      margin: 15px 0 8px 0;
      font-weight: 600;
      color: #2d3748;
      font-size: 0.95em;
    }

    input,
    textarea,
    select {
      width: 100%;
      padding: 12px;
      border: 1px solid #e2e8f0;
      border-radius: 6px;
      font-size: 15px;
      transition: border-color 0.2s, box-shadow 0.2s;
      background: #f8fafc;
    }

    input:focus,
    textarea:focus,
    select:focus {
      outline: none;
      border-color: #33bdef;
      background: white;
      box-shadow: 0 0 0 3px rgba(51, 189, 239, 0.1);
    }

    textarea {
      min-height: 400px;
      font-family: 'Consolas', 'Monaco', monospace;
      line-height: 1.6;
    }

    .form-row {
      margin-bottom: 20px;
    }

    .form-row.half {
      width: 49%;
      display: inline-block;
      margin-right: 2%;
      vertical-align: top;
    }

    .form-row.half:last-child {
      margin-right: 0;
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      gap: 25px;
      margin: 30px 0;
    }

    .stat-card {
      background: white;
      padding: 30px;
      border-radius: 12px;
      text-align: center;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.02);
      border: 1px solid #e1e4e8;
      transition: transform 0.2s;
    }

    .stat-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 15px rgba(0, 0, 0, 0.05);
    }

    .stat-number {
      font-size: 2.5em;
      font-weight: 700;
      color: #33bdef;
      margin-bottom: 5px;
    }

    .stat-label {
      color: #718096;
      font-weight: 500;
    }

    .recent-activity {
      background: white;
      padding: 25px;
      border-radius: 12px;
      margin: 30px 0;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.02);
      border: 1px solid #e1e4e8;
    }

    .activity-item {
      padding: 12px 0;
      border-bottom: 1px solid #f0f4f8;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .activity-item:last-child {
      border-bottom: none;
    }

    .badge {
      display: inline-block;
      padding: 4px 10px;
      border-radius: 20px;
      font-size: 0.75em;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .badge.blog {
      background: #c6f6d5;
      color: #22543d;
    }

    .badge.hub {
      background: #feebc8;
      color: #744210;
    }

    .badge.author {
      background: #bee3f8;
      color: #2a4365;
    }

    .badge.notification {
      background: #fed7d7;
      color: #742a2a;
    }

    @media (max-width: 1024px) {
      .cms-sidebar {
        width: 80px;
        padding: 20px 10px;
      }

      .cms-nav-item {
        text-align: center;
        padding: 15px 5px;
        font-size: 1.5em;
      }

      .cms-sidebar h3 {
        display: none;
      }

      .cms-main {
        margin-left: 80px;
        padding: 20px;
      }
    }

    @media (max-width: 768px) {
      .cms-sidebar {
        display: none;
      }

      .cms-main {
        margin-left: 0;
        padding: 15px;
      }

      .stats-grid {
        grid-template-columns: 1fr;
      }

      .form-row.half {
        width: 100%;
        margin-right: 0;
      }

      .modal-content {
        width: 95%;
        margin: 10px auto;
        padding: 20px;
      }
    }
  </style>
</head>

<body>
  <nav class="cms-sidebar">
    <h3>üìä Dashboard</h3>
    <a href="#" class="cms-nav-item active" onclick="showSection('overview')">Overview</a>
    <a href="#" class="cms-nav-item" onclick="showSection('blog')">üìù Blog Posts</a>
    <a href="#" class="cms-nav-item" onclick="showSection('hubs')">üîó Content Hubs</a>
    <a href="#" class="cms-nav-item" onclick="showSection('authors')">üë• Authors</a>
    <a href="#" class="cms-nav-item" onclick="showSection('notifications')">üîî Notifications</a>
    <a href="#" class="cms-nav-item" onclick="showSection('pages')">üìÑ Pages</a>
    <a href="#" class="cms-nav-item" onclick="showSection('media')">üñºÔ∏è Media</a>
    <a href="#" class="cms-nav-item" onclick="showSection('analytics')">üìà Analytics</a>
  </nav>

  <main class="cms-main">
    <section id="overview" class="content-section active">
      <h1>üìä Content Management Dashboard</h1>
      <p>Complete control over your EvolvedLotus blog and content</p>

      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-number">0</div>
          <div class="stat-label">Blog Posts</div>
        </div>
        <div class="stat-card">
          <div class="stat-number">0</div>
          <div class="stat-label">Content Hubs</div>
        </div>
        <div class="stat-card">
          <div class="stat-number">0</div>
          <div class="stat-label">Authors</div>
        </div>
        <div class="stat-card">
          <div class="stat-number">1K+</div>
          <div class="stat-label">Monthly Visitors</div>
        </div>
      </div>

      <div class="recent-activity">
        <h3>üïê Recent Activity</h3>
        <div class="activity-item">
          <span class="badge blog">Blog</span> Published "Mobile Photography Techniques for Better Content"
        </div>
        <!-- Static placeholders for now, could be dynamic later -->
      </div>
    </section>

    <section id="blog" class="content-section">
      <h1>üìù Blog Posts Management</h1>
      <div style="margin: 20px 0;">
        <button class="btn primary" onclick="createNewContent('blog')">+ New Blog Post</button>
        <button class="btn" onclick="refreshSection('blog')">üîÑ Refresh</button>
      </div>
      <div id="blogList" class="content-list">
        <p>Loading...</p>
      </div>
    </section>

    <section id="hubs" class="content-section">
      <h1>üîó Content Hubs Management</h1>
      <div style="margin: 20px 0;">
        <button class="btn primary" onclick="createNewContent('hub')">+ New Hub Content</button>
        <button class="btn" onclick="refreshSection('hubs')">üîÑ Refresh</button>
      </div>
      <div id="hubsList" class="content-list">
        <p>Loading...</p>
      </div>
    </section>

    <section id="authors" class="content-section">
      <h1>üë• Authors Management</h1>
      <div style="margin: 20px 0;">
        <button class="btn primary" onclick="createNewContent('author')">+ New Author</button>
        <button class="btn" onclick="refreshSection('authors')">üîÑ Refresh</button>
      </div>
      <div id="authorsList" class="content-list">
        <p>Loading...</p>
      </div>
    </section>

    <section id="notifications" class="content-section">
      <h1>üîî Notifications Management</h1>
      <div style="margin: 20px 0;">
        <button class="btn primary" onclick="createNewContent('notification')">+ New Notification</button>
        <button class="btn" onclick="refreshSection('notifications')">üîÑ Refresh</button>
      </div>
      <div id="notificationsList" class="content-list">
        <p>Loading...</p>
      </div>
    </section>

    <section id="pages" class="content-section">
      <h1>üìÑ Pages Management</h1>
      <div style="margin: 20px 0;">
        <button class="btn primary" onclick="createNewContent('page')">+ New Page</button>
        <button class="btn" onclick="refreshSection('pages')">üîÑ Refresh</button>
      </div>
      <div id="pagesList" class="content-list">
        <p>Loading...</p>
      </div>
    </section>

    <section id="media" class="content-section">
      <h1>üñºÔ∏è Media Management</h1>
      <div style="margin: 20px 0;">
        <button class="btn primary" onclick="createNewContent('media')">+ Upload Media</button>
        <button class="btn" onclick="refreshSection('media')">üîÑ Refresh</button>
      </div>
      <div id="mediaList" class="content-list">
        <p>Loading...</p>
      </div>
    </section>

    <section id="analytics" class="content-section">
      <h1>üìà Content Analytics</h1>
      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-number">2.4K</div>
          <div class="stat-label">Page Views (Today)</div>
        </div>
        <div class="stat-card">
          <div class="stat-number">45</div>
          <div class="stat-label">Hours Read (Today)</div>
        </div>
        <div class="stat-card">
          <div class="stat-number">12</div>
          <div class="stat-label">Articles Published (This Month)</div>
        </div>
        <div class="stat-card">
          <div class="stat-number">89%</div>
          <div class="stat-label">Search Satisfaction</div>
        </div>
      </div>
    </section>
  </main>

  <!-- Content Editor Modal -->
  <div id="editModal" class="modal">
    <div class="modal-content">
      <div style="display:flex; justify-content:space-between; align-items:center;">
        <h2 id="modalTitle" style="margin:0;">Content Editor</h2>
        <button onclick="closeModal()"
          style="background:none; border:none; font-size:1.5em; cursor:pointer;">&times;</button>
      </div>
      <form id="contentForm">
        <input type="hidden" id="contentType">

        <!-- üìù BLOG POST FIELDS -->
        <div id="blogFields" class="form-section">
          <div class="form-row">
            <label for="blogTitle">Post Title:</label>
            <input type="text" id="blogTitle" placeholder="10 Tips for...">
          </div>
          <div class="form-row">
            <label for="blogDesc">Description (SEO):</label>
            <textarea id="blogDesc" rows="2"></textarea>
          </div>
          <div class="form-row half">
            <label for="blogDate">Publish Date:</label>
            <input type="datetime-local" id="blogDate" required>
          </div>
          <div class="form-row half">
            <label for="blogAuthor">Author:</label>
            <input type="text" id="blogAuthor" value="EvolvedLotus Team">
          </div>
          <div class="form-row">
            <label for="blogTags">Tags (comma-separated):</label>
            <input type="text" id="blogTags" placeholder="marketing, guide, 2024">
          </div>
          <div class="form-row half">
            <label for="blogCategory">Category:</label>
            <select id="blogCategory">
              <option value="">Select Category</option>
              <option value="content-creation">Content Creation</option>
              <option value="social-media">Social Media</option>
              <option value="seo">SEO</option>
              <option value="analytics">Analytics</option>
              <option value="tools">Tools & Resources</option>
            </select>
          </div>
          <div class="form-row half">
            <label for="blogImage">Featured Image URL:</label>
            <input type="text" id="blogImage" placeholder="/assets/blog/...">
          </div>
          <div class="form-row">
            <label><input type="checkbox" id="blogFeatured"> Featured</label>
            <label style="margin-left:15px;"><input type="checkbox" id="blogDraft"> Draft</label>
          </div>

          <h4 style="border-bottom:1px solid #eee; padding-bottom:5px; margin-top:20px;">SEO Advanced</h4>
          <div class="form-row"><input type="text" id="blogImageAlt" placeholder="Image Alt Text"></div>
          <div class="form-row"><input type="text" id="blogKeywords" placeholder="Keywords (comma sep)"></div>
          <div class="form-row half">
            <select id="blogSchema">
              <option value="Article">Article Schema</option>
              <option value="BlogPosting">BlogPosting</option>
            </select>
          </div>
          <div class="form-row half">
            <select id="blogOg">
              <option value="article">OG: Article</option>
              <option value="website">OG: Website</option>
            </select>
          </div>
        </div>

        <!-- üîó HUB FIELDS -->
        <div id="hubFields" class="form-section">
          <div class="form-row">
            <label for="hubTitle">Hub Title:</label>
            <input type="text" id="hubTitle">
          </div>
          <div class="form-row">
            <label for="hubDesc">Description:</label>
            <textarea id="hubDesc" rows="3"></textarea>
          </div>
          <div class="form-row">
            <label for="hubCollection">Hub Collection Strategy:</label>
            <select id="hubCollection">
              <option value="tiktok">TikTok (tiktok)</option>
              <option value="instagram">Instagram (instagram)</option>
              <option value="youtube">YouTube (youtube)</option>
              <option value="ai">AI Tools (ai)</option>
            </select>
          </div>
          <div class="form-row">
            <label for="hubPermalink">Permalink:</label>
            <input type="text" id="hubPermalink" placeholder="/hubs/my-topic/">
          </div>
        </div>

        <!-- üë• AUTHOR FIELDS -->
        <div id="authorFields" class="form-section">
          <div class="form-row half">
            <label for="authorName">Full Name:</label>
            <input type="text" id="authorName">
          </div>
          <div class="form-row half">
            <label for="authorRole">Role:</label>
            <input type="text" id="authorRole">
          </div>
          <div class="form-row">
            <label for="authorBio">Bio:</label>
            <textarea id="authorBio" rows="3"></textarea>
          </div>
          <div class="form-row">
            <label for="authorAvatar">Avatar URL:</label>
            <input type="text" id="authorAvatar" placeholder="/assets/authors/name.png">
          </div>
          <div class="form-row">
            <label>Social Media Links:</label>
            <input type="url" id="authorTwitter" placeholder="Twitter URL" style="margin-bottom:5px;">
            <input type="url" id="authorInsta" placeholder="Instagram URL" style="margin-bottom:5px;">
            <input type="url" id="authorTiktok" placeholder="TikTok URL">
          </div>
          <div class="form-row">
            <label for="authorExpertise">Expertise (One per line):</label>
            <textarea id="authorExpertise" rows="4"></textarea>
          </div>
        </div>

        <!-- üîî NOTIFICATION FIELDS -->
        <div id="notificationFields" class="form-section">
          <div class="form-row">
            <label for="notifTitle">Title:</label>
            <input type="text" id="notifTitle">
          </div>
          <div class="form-row">
            <label for="notifDate">Date:</label>
            <input type="date" id="notifDate">
          </div>
          <div class="form-row">
            <label for="notifLink">Link (Optional):</label>
            <input type="url" id="notifLink">
          </div>
          <div class="form-row">
            <label for="notifTags">Tags:</label>
            <input type="text" id="notifTags" value="notification" placeholder="notification, alert">
          </div>
        </div>

        <!-- üìÑ PAGE FIELDS -->
        <div id="pageFields" class="form-section">
          <div class="form-row">
            <label for="pageTitle">Page Title:</label>
            <input type="text" id="pageTitle">
          </div>
          <div class="form-row">
            <label for="pageLayout">Layout:</label>
            <input type="text" id="pageLayout" value="page.njk">
          </div>
          <div class="form-row">
            <label for="pagePermalink">Permalink:</label>
            <input type="text" id="pagePermalink" placeholder="/my-page/">
          </div>
        </div>

        <!-- üñºÔ∏è MEDIA FIELDS -->
        <div id="mediaFields" class="form-section">
          <div class="form-row">
            <label>Select File to Upload:</label>
            <div style="border: 2px dashed #ccc; padding: 40px; text-align:center; border-radius:8px; cursor:pointer;"
              onclick="alert('Drag & drop simulated')">
              <p>üìÇ Drag and drop files here or click to browse</p>
              <small>(Static Demo - No backend upload service)</small>
            </div>
          </div>
        </div>

        <!-- COMMON CONTENT TEXTAREA (Shared by Blog, Hub, Page, Notif) -->
        <div class="form-row" id="commonContentRow">
          <label for="mainContent">Body Content (Markdown):</label>
          <textarea id="mainContent" style="min-height:300px;"></textarea>
        </div>

        <div class="form-row">
          <button type="submit" class="btn primary">Save & Copy Code</button>
          <button type="button" class="btn" onclick="closeModal()">Cancel</button>
        </div>
      </form>
    </div>
  </div>

  <script>
    let currentSection = 'overview';
    let contentData = {};

    function showSection(name) {
      document.querySelectorAll('.content-section').forEach(s => s.classList.remove('active'));
      document.querySelectorAll('.cms-nav-item').forEach(i => i.classList.remove('active'));
      document.getElementById(name).classList.add('active');
      event.target.classList.add('active');
      currentSection = name;
    }

    function refreshSection(sec) {
      if (sec === 'blog') loadBlogPosts();
      if (sec === 'hubs') loadHubContent();
      if (sec === 'authors') loadAuthors();
      if (sec === 'notifications') loadNotifications();
      if (sec === 'pages') loadPages();
      if (sec === 'media') loadMedia();
    }

    async function loadContentData() {
      try {
        const res = await fetch('/api/posts.json');
        const data = await res.json();
        contentData = data;
        if (data.stats) {
          const stats = document.querySelectorAll('.stat-number');
          if (stats.length >= 3) {
            stats[0].textContent = data.stats.totalBlogPosts;
            stats[1].textContent = data.stats.totalHubs;
            stats[2].textContent = data.stats.totalAuthors;
          }
        }
        return data;
      } catch (e) { console.error(e); }
    }

    // loaders
    function loadBlogPosts() {
      const posts = contentData.blog || [];
      document.getElementById('blogList').innerHTML = posts.length ? posts.map(p => `
        <div class="content-item">
          <h4>${p.title} ${p.featured ? '<span class="badge">FEATURED</span>' : ''}</h4>
          <div class="content-meta">Published: ${p.date} | ${p.author}</div>
          <div class="content-actions">
            <button class="btn info" onclick="editContent('blog','${p.id}')">Edit</button>
            <button class="btn success" onclick="viewContent('${p.url}')">View</button>
          </div>
        </div>`).join('') : '<p>No posts.</p>';
    }
    function loadHubContent() {
      const hubs = contentData.hubs || [];
      document.getElementById('hubsList').innerHTML = hubs.length ? hubs.map(h => `
        <div class="content-item">
          <h4>${h.title}</h4>
          <div class="content-meta">${h.platform}</div>
          <div class="content-actions"><button class="btn info" onclick="editContent('hub','${h.id}')">Edit</button></div>
        </div>`).join('') : '<p>No hubs.</p>';
    }
    function loadAuthors() {
      const auths = contentData.authors || [];
      document.getElementById('authorsList').innerHTML = auths.length ? auths.map(a => `
        <div class="content-item">
          <h4>${a.name}</h4>
          <div class="content-meta">${a.role}</div>
          <div class="content-actions"><button class="btn info" onclick="editContent('author','${a.id}')">Edit</button></div>
        </div>`).join('') : '<p>No authors.</p>';
    }
    function loadNotifications() {
      document.getElementById('notificationsList').innerHTML = '<p>Check _src/blog/notifications/_ logic needed.</p>';
    }
    function loadPages() {
      document.getElementById('pagesList').innerHTML = '<p>Static pages (About/Contact) managed via src/pages/.</p>';
    }
    async function loadMedia() {
      try {
        const r = await fetch('/api/media.json');
        const d = await r.json();
        const list = d.media || [];
        document.getElementById('mediaList').innerHTML = list.length ? `<div style="display:grid;grid-template-columns:repeat(auto-fill,minmax(120px,1fr));gap:10px;">
            ${list.map(f => `<div class="content-item" style="text-align:center;padding:5px;">
              <img src="${f.path}" style="height:80px;width:100%;object-fit:cover;">
              <div style="font-size:0.7em;overflow:hidden;text-overflow:ellipsis;">${f.name}</div>
              <button class="btn info" style="font-size:0.6em;padding:2px;" onclick="navigator.clipboard.writeText('${f.path}');alert('Copied!')">Copy URL</button>
            </div>`).join('')}</div>` : '<p>No media.</p>';
      } catch (e) { }
    }

    // CREATE / EDIT
    function createNewContent(type) {
      document.getElementById('contentForm').reset();
      document.getElementById('contentType').value = type;
      document.getElementById('modalTitle').textContent = 'Create New ' + type.charAt(0).toUpperCase() + type.slice(1);

      // Hide all sections
      document.querySelectorAll('.form-section').forEach(el => el.classList.remove('active'));
      document.getElementById('commonContentRow').style.display = (type === 'media') ? 'none' : 'block';

      // Show specific section
      if (type === 'blog') document.getElementById('blogFields').classList.add('active');
      if (type === 'hub') document.getElementById('hubFields').classList.add('active');
      if (type === 'author') document.getElementById('authorFields').classList.add('active');
      if (type === 'notification') document.getElementById('notificationFields').classList.add('active');
      if (type === 'page') document.getElementById('pageFields').classList.add('active');
      if (type === 'media') document.getElementById('mediaFields').classList.add('active');

      document.getElementById('editModal').style.display = 'block';

      // Defaults
      if (type === 'blog') {
        const now = new Date();
        now.setMinutes(now.getMinutes() - now.getTimezoneOffset());
        document.getElementById('blogDate').value = now.toISOString().slice(0, 16);
      }
    }

    function editContent(type, id) {
      createNewContent(type); // Reset and show form
      document.getElementById('modalTitle').textContent = 'Edit ' + type;

      const item = contentData[type]?.find(i => i.id === id);
      if (!item) return;

      if (type === 'blog') {
        document.getElementById('blogTitle').value = item.title || '';
        document.getElementById('blogDesc').value = item.description || '';
        document.getElementById('blogDate').value = item.date + 'T12:00';
        document.getElementById('blogAuthor').value = item.author || 'EvolvedLotus Team';
        document.getElementById('blogTags').value = item.tags ? (Array.isArray(item.tags) ? item.tags.join(',') : item.tags) : '';
        document.getElementById('blogCategory').value = item.category || '';
        document.getElementById('blogImage').value = item.image || '';
        document.getElementById('blogImageAlt').value = item.imageAlt || '';
        document.getElementById('blogKeywords').value = item.keywords || '';
        document.getElementById('blogSchema').value = item.schema_type || 'Article';
        document.getElementById('blogOg').value = item.og_type || 'article';
        document.getElementById('blogFeatured').checked = !!item.featured;
        document.getElementById('blogDraft').checked = !!item.draft;
      }
      if (type === 'hub') {
        document.getElementById('hubTitle').value = item.title || '';
        document.getElementById('hubDesc').value = item.description || '';
        document.getElementById('hubCollection').value = item.platform || '';
        document.getElementById('hubPermalink').value = item.url || '';
      }
      if (type === 'author') {
        document.getElementById('authorName').value = item.name || '';
        document.getElementById('authorRole').value = item.role || '';
        document.getElementById('authorBio').value = item.bio || '';
        // Map expertise if array
        if (item.expertise && Array.isArray(item.expertise)) {
          document.getElementById('authorExpertise').value = item.expertise.join('\n');
        }
      }

      document.getElementById('mainContent').value = "Content loading skipped for static demo.";
    }

    function generateFrontmatter(e) {
      e.preventDefault();
      const type = document.getElementById('contentType').value;
      let fm = '---\n';
      let filename = 'content';

      if (type === 'blog') {
        const t = document.getElementById('blogTitle').value;
        fm += `title: "${t.replace(/"/g, '\\"')}"\n`;
        fm += `description: "${document.getElementById('blogDesc').value.replace(/"/g, '\\"')}"\n`;
        fm += `date: ${new Date(document.getElementById('blogDate').value).toISOString()}\n`;
        fm += `author: "${document.getElementById('blogAuthor').value}"\n`;
        const tags = document.getElementById('blogTags').value;
        if (tags) { fm += 'tags:\n'; tags.split(',').forEach(t => fm += `  - ${t.trim()}\n`); }
        const img = document.getElementById('blogImage').value;
        if (img) fm += `image: ${img}\n`;
        const cat = document.getElementById('blogCategory').value;
        if (cat) fm += `category: ${cat}\n`;
        if (document.getElementById('blogFeatured').checked) fm += `featured: true\n`;
        if (document.getElementById('blogDraft').checked) fm += `draft: true\n`;
        const alt = document.getElementById('blogImageAlt').value;
        if (alt) fm += `imageAlt: "${alt}"\n`;
        const kw = document.getElementById('blogKeywords').value;
        if (kw) fm += `keywords: "${kw}"\n`;
        fm += `schema_type: ${document.getElementById('blogSchema').value}\n`;
        fm += `og_type: ${document.getElementById('blogOg').value}\n`;
        filename = 'blog/' + document.getElementById('blogDate').value.split('T')[0] + '-' + t.toLowerCase().replace(/[^a-z0-9]+/g, '-');
      }
      else if (type === 'hub') {
        const t = document.getElementById('hubTitle').value;
        fm += `layout: hub.njk\n`;
        fm += `title: "${t}"\n`;
        fm += `description: "${document.getElementById('hubDesc').value}"\n`;
        fm += `hubCollection: ${document.getElementById('hubCollection').value}\n`;
        fm += `permalink: ${document.getElementById('hubPermalink').value}\n`;
        filename = 'hubs/' + t.toLowerCase().replace(/[^a-z0-9]+/g, '-');
      }
      else if (type === 'author') {
        const n = document.getElementById('authorName').value;
        fm += `name: "${n}"\n`;
        fm += `slug: ${n.toLowerCase().replace(/ /g, '-')}\n`;
        fm += `role: "${document.getElementById('authorRole').value}"\n`;
        fm += `bio: "${document.getElementById('authorBio').value}"\n`;
        const av = document.getElementById('authorAvatar').value;
        if (av) fm += `avatar: ${av}\n`;
        fm += `social:\n`;
        if (document.getElementById('authorTwitter').value) fm += `  twitter: ${document.getElementById('authorTwitter').value}\n`;
        if (document.getElementById('authorInsta').value) fm += `  instagram: ${document.getElementById('authorInsta').value}\n`;
        if (document.getElementById('authorTiktok').value) fm += `  tiktok: ${document.getElementById('authorTiktok').value}\n`;
        const exp = document.getElementById('authorExpertise').value;
        if (exp) { fm += `expertise:\n`; exp.split('\n').forEach(x => { if (x.trim()) fm += `  - ${x.trim()}\n`; }); }
        filename = 'authors/' + n.toLowerCase().replace(/ /g, '-');
      }
      else if (type === 'notification') {
        const t = document.getElementById('notifTitle').value;
        fm += `title: "${t}"\n`;
        fm += `date: ${document.getElementById('notifDate').value}\n`;
        if (document.getElementById('notifLink').value) fm += `link: ${document.getElementById('notifLink').value}\n`;
        fm += `tags:\n  - notification\n`;
        filename = 'notifications/' + t.toLowerCase().replace(/[^a-z0-9]+/g, '-');
      }
      else if (type === 'page') {
        const t = document.getElementById('pageTitle').value;
        fm += `title: "${t}"\n`;
        fm += `layout: ${document.getElementById('pageLayout').value}\n`;
        fm += `permalink: ${document.getElementById('pagePermalink').value}\n`;
        filename = 'pages/' + t.toLowerCase().replace(/[^a-z0-9]+/g, '-');
      }

      fm += '---\n\n' + document.getElementById('mainContent').value;

      navigator.clipboard.writeText(fm).then(() => alert(`Copied to clipboard!\nCreate: src/${filename}.md`));
    }

    document.getElementById('contentForm').addEventListener('submit', generateFrontmatter);
    function viewContent(url) { window.open(url, '_blank'); }
    function closeModal() { document.getElementById('editModal').style.display = 'none'; }
    window.onclick = function (e) { if (e.target == document.getElementById('editModal')) closeModal(); }

    window.onload = async function () {
      await loadContentData();
      loadBlogPosts();
      loadHubContent();
      loadAuthors();
      loadMedia();
    }


  </script>
</body>

</html>